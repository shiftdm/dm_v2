# DM v2 - Flujo local (sin n8n)
# Copiar a docker-compose.yml y ajustar las variables marcadas como CAMBIAR

services:
  insta-dm-browser:
    image: ghcr.io/shiftdm/dm_v2:latest
    container_name: dm-instance-1

    # -------------------------
    # Puertos (NO CAMBIAR 3001 y 6080 internos)
    # Mapeo HOST:CONTAINER — por instancia usar puertos distintos en HOST
    # -------------------------
    ports:
      - "3001:3001"   # Dashboard
      - "6080:6080"   # noVNC (browser)

    environment:
      # --- NO CAMBIAR ---
      PUPPETEER_EXECUTABLE_PATH: "/opt/puppeteer-chrome"
      NODE_ENV: "production"
      PORT: "3001"

      # --- CAMBIAR: tu conexión PostgreSQL ---
      DATABASE_URL: "postgresql://usuario:contraseña@host:5432/nombre_bd?sslmode=require"

      # --- CAMBIAR: credenciales del dashboard web ---
      DASH_USER: "admin"
      DASH_PASS: "tu_password_seguro"

      # --- CAMBIAR: usuario Instagram (debe existir en tabla accounts) ---
      LOGIN_USERNAME: "tu_usuario_instagram"

      # --- CAMBIAR si usas tabla distinta a leads ---
      TABLE_NAME: "leads"

      # --- Opcionales (valores por defecto si no se definen) ---
      DELAY_STORIES_MIN: "3"
      DELAY_STORIES_MAX: "5"
      LEADS_PER_CYCLE: "15"
      WAIT_BETWEEN_CYCLES_MIN: "2"
      # send_interval_minutes, timezone, daily_message_limit → tabla accounts

    restart: unless-stopped
